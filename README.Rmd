---
title: "Reproducing Results of Gerard, Ferrao, and Stephens (2017)"
bibliography: geno_bib.bib
output: github_document
---

# Introduction

This repository contains code to reproduce the empirical evaluations
of @gerard2017harnessing. The new methods can be found in the
[updog](https://github.com/dcgerard/updog) package.

```{r, echo=FALSE, results="hide", message=FALSE}
liblist <- list("tidyverse", "updog", "rmutil", "snow", "parallel")
lapply(liblist, require, character.only = TRUE)
```

If you are having trouble reproducing these results, it might be that you need to update some of your R packages. These are the versions that I used:

```{r}
sessionInfo()
```

As you can see above, I've also only tried this out on Ubuntu.

If you find a bug, please create an
[issue](https://github.com/dcgerard/reproduce_genotyping/issues).

# Instructions

To reproduce the results in @gerard2017harnessing, you need to (1) download and install the appropriate packages, (2) obtain the appropriate data, (3) run `make`, and (4) get coffee.

## Install Packages

To install the needed R packages, run the following in R

```{r, eval = FALSE}
install.packages(c("tidyverse", "rmutil", "snow", "parallel"))
devtools::install_github("dcgerard/updog")
```

Please follow the directions [here](https://github.com/pblischak/polyploid-genotyping/tree/master/ebg) to install `ebg`.

## Get Data

Place the following files in the Data folder:

1. [KDRIsweetpotatoXushu18S1LG2017.vcf.gz](http://sweetpotato-garden.kazusa.or.jp/)

The actual URL is: ftp://ftp.kazusa.or.jp/pub/sweetpotato/GeneticMap/

## Run Make

To reproduce all of the results in @gerard2017harnessing, simply run
`make` from the terminal. To reproduce the real-data analysis, run
``` bash
make sweet_potato
```
To reproduce the simulations, run
``` r
make simulations
```

## Get Coffee

The simulations should take a few hours. You should get some coffee. Here is a list of some of my favorite places:

* Chicago
    - [Sawada Coffee](https://www.yelp.com/biz/sawada-coffee-chicago)
    - [Plein Air Cafe](https://www.yelp.com/biz/plein-air-cafe-and-eatery-chicago-2)
* Seattle
    - [Bauhaus Ballard](https://www.yelp.com/biz/bauhaus-ballard-seattle)
    - [Cafe Solstice](https://www.yelp.com/biz/cafe-solstice-seattle)
* Columbus
    - [Yeah, Me Too](https://www.yelp.com/biz/yeah-me-too-columbus)
    - [Stauf's Coffee Roasters](https://www.yelp.com/biz/staufs-coffee-roasters-columbus-2)
    - [Caffe Apropos](https://www.yelp.com/biz/caff%C3%A9-apropos-columbus-2)
    
    
# Note on SuperMASSA

There appears to be no way to automate [SuperMASSA](http://statgen.esalq.usp.br/SuperMASSA/). As such, I've committed the inputs and fits in the [Output](https://github.com/dcgerard/reproduce_genotyping/tree/master/Output/supermassa_formatted_data) folder. If you want to generate these fits, you'll have to do it manually.

# References

